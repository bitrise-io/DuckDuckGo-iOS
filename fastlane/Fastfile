fastlane_version "2.150.0"

default_platform :ios

lane :release do 

  gym(
    codesigning_identity: "Apple Distribution: Duck Duck Go, Inc.",
    scheme: "DuckDuckGo",
    export_method: "app-store",
    export_options: {
      method: "app-store",
      signingStyle: "manual",
      provisioningProfiles: {
        "com.duckduckgo.mobile.ios" => "AppStore-App",
	"com.duckduckgo.mobile.ios.ShareExtension" => "AppStore-Share",
	"com.duckduckgo.mobile.ios.BookmarksTodayExtension" => "AppStore-Bookmarks",
	"com.duckduckgo.mobile.ios.QuickActionsTodayExtension" => "AppStore-QuickActions",
	"com.duckduckgo.mobile.ios.OpenAction2" => "AppStore-OpenAction",
	"com.duckduckgo.mobile.ios.Widgets" => "AppStore-Widgets"
      }
    }
  )

  deliver(
    submit_for_review: false,
    automatic_release: false, 
    phased_release: true,
    username: "jenkins-itunes@duckduckgo.com",
    force: true,
    skip_screenshots: true,
    precheck_include_in_app_purchases: false,
    submission_information: {
       add_id_info_uses_idfa: false
    }
  )

end

